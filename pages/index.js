import Head from "next/head";
import { useState } from "react";
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend,
} from "chart.js";
import { Line } from "react-chartjs-2";
import { useAppContext } from "../components/utils/context";

ChartJS.register(
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend
);

export default function Home() {
  const { Population, options, data, genMembers } = useAppContext();

  const handleGenerate = (
    populationSize,
    target,
    mutationRate,
    generations
  ) => {
    const population = new Population(populationSize, target, mutationRate);
    population.evolve(generations);
  };

  return (
    <div className="min-h-screen flex">
      <Head>
        <title>Genetic Algorithm</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      {/* sidebar */}
      <div className="side-bar">
        <h3 className="font-semibold">Settings</h3>
        <button
          className="btn-primary"
          onClick={() => handleGenerate(30, "xy", 0.05, 25)}
        >
          SUBMIT
        </button>
      </div>
      <div className="main-container">
        <h1 className="font-bold">Genetic Algorithm</h1>
        <h2 className="font-medium">Fitness Chart</h2>
        <div className="border">
          <Line options={options} data={data} />
        </div>
        {genMembers.map((members, i) => (
          <div key={i}>{members}</div>
        ))}
      </div>
    </div>
  );
}
